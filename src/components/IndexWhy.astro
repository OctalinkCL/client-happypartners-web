<section id="why" class="py-12 bg-midnight lg:py-24">
  <div class="container mx-auto px-4 lg:px-0">
    <div class="flex flex-col justify-center items-center">
      <div class="flex items-center gap-3 mb-4">
        <div class="size-[12px] relative flex items-center justify-center">
          <div class="absolute size-full bg-lila rounded-full z-10"></div>
        </div>
        <p class="font-display text-sm text-lila font-light lg:text-lg">
          ¿Por qué medir la felicidad?
        </p>
      </div>

      <div class="slider-container text-white text-center">
        <div id="phraseSlider" class="slider h-[150px]">
          <div class="slide" data-index="0">
            <h3 class="text-4xl font-display font-semibold lg:text-6xl">
              Lo que no se mide, no se gestiona.
            </h3>
          </div>
          <div class="slide" data-index="1">
            <h3 class="text-4xl font-display font-semibold lg:text-6xl">
              Si puedes soñarlo, puedes lograrlo.
            </h3>
          </div>
          <div class="slide" data-index="2">
            <h3 class="text-4xl font-display font-semibold lg:text-6xl">
              El éxito es la suma de pequeños esfuerzos.
            </h3>
          </div>
        </div>
        <div class="dots-container">
          <button class="dot" data-index="0" aria-label="Go to slide 1"
          ></button>
          <button class="dot" data-index="1" aria-label="Go to slide 2"
          ></button>
          <button class="dot" data-index="2" aria-label="Go to slide 3"
          ></button>
        </div>
      </div>
    </div>
  </div>
</section>

<style>
  /* Estilos para el contenedor del slider */
  .slider-container {
    position: relative;
    overflow: hidden; /* Oculta las frases que no están activas */
    padding-bottom: 3rem; /* Espacio para los dots */
    width: 100%; /* Asegura que el contenedor ocupe el ancho disponible */
  }

  /* Estilos para el carrusel de frases */
  .slider {
    display: flex;
    transition: transform 0.8s ease-in-out; /* Animación de la transición */
  }

  /* Estilos para cada slide (frase) */
  .slide {
    min-width: 100%; /* Cada slide ocupa el 100% del ancho del slider */
    flex-shrink: 0; /* Asegura que no se encojan */
    display: flex;
    justify-content: center;
    align-items: center;
    opacity: 0; /* Por defecto, oculto */
    transition: opacity 0.8s ease-in-out;
    position: absolute; /* Permite que las slides se superpongan */
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
  }

  /* Clase para la slide activa */
  .slide.active {
    opacity: 1;
    position: static; /* Ocupa su lugar en el flujo cuando está activa */
  }

  /* Estilos para el contenedor de los dots */
  .dots-container {
    position: absolute;
    bottom: 0.5rem; /* Ajusta según sea necesario para la distancia de los dots */
    left: 50%;
    transform: translateX(-50%);
    display: flex;
    gap: 0.5rem; /* Espacio entre los dots */
    z-index: 10; /* Asegura que los dots estén por encima de las slides */
  }

  /* Estilos para cada dot */
  .dot {
    width: 12px;
    height: 12px;
    border-radius: 50%;
    background-color: rgba(
      255,
      255,
      255,
      0.5
    ); /* Color de los dots inactivos */
    border: none;
    cursor: pointer;
    transition: background-color 0.3s ease;
  }

  /* Estilos para el dot activo */
  .dot.active {
    background-color: #fff; /* Color del dot activo */
  }
</style>

<script>
  // Script para la lógica del slider
  document.addEventListener("DOMContentLoaded", () => {
    const sliderContainer = document.querySelector(".slider-container");
    if (!sliderContainer) return;

    const slides = Array.from(sliderContainer.querySelectorAll(".slide"));
    const dotsContainer = sliderContainer.querySelector(".dots-container");
    if (!dotsContainer) return;

    const dots = Array.from(dotsContainer.querySelectorAll(".dot"));

    let currentIndex = 0;
    let autoPlayInterval: NodeJS.Timeout;
    const intervalTime = 3000; // Cambia cada 3 segundos (3000 ms)

    // Función para mostrar la slide actual
    function showSlide(index: number) {
      // Oculta todas las slides y desactiva todos los dots
      slides.forEach((slide) => slide.classList.remove("active"));
      dots.forEach((dot) => dot.classList.remove("active"));

      // Muestra la slide actual y activa el dot correspondiente
      slides[index].classList.add("active");
      dots[index].classList.add("active");
    }

    // Función para avanzar a la siguiente slide
    function nextSlide() {
      currentIndex = (currentIndex + 1) % slides.length;
      showSlide(currentIndex);
    }

    // Iniciar el autoplay
    function startAutoPlay() {
      stopAutoPlay(); // Asegura que no haya intervalos duplicados
      autoPlayInterval = setInterval(nextSlide, intervalTime);
    }

    // Detener el autoplay
    function stopAutoPlay() {
      clearInterval(autoPlayInterval);
    }

    // Manejar clics en los dots
    dots.forEach((dot) => {
      dot.addEventListener("click", () => {
        const index = parseInt((dot as HTMLElement).dataset.index || "0");
        stopAutoPlay(); // Detiene el autoplay al interactuar
        showSlide(index);
        startAutoPlay(); // Reinicia el autoplay
      });
    });

    // Iniciar al cargar la página
    showSlide(currentIndex); // Muestra la primera slide al inicio
    startAutoPlay(); // Comienza el autoplay
  });
</script>
